---

title: Import Sandbag data

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/Process Sandbag data - Find infrastructure location.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This script enables to find the location of ETS infrastructure (provided by Sandbag) using OpenStreetMap via the GeoPy module.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path_sandbag</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\amelie.dubourg\Desktop\Personnel\Data for Good\Sandbag\Sandbag Export Emissions2019.csv&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path_sandbag</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>
<span class="n">sandbag_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InstallationNumber</th>
      <th>InstallationName</th>
      <th>Key</th>
      <th>RegCtryName</th>
      <th>SandbagSector</th>
      <th>tCO2e</th>
      <th>InstallationLatitude</th>
      <th>InstallationLongtitude</th>
      <th>InstallationPostCode</th>
      <th>InstallationCity</th>
      <th>InstallationAddress1</th>
      <th>InstallationAddress2</th>
      <th>MainActivityType</th>
      <th>ClassDescription</th>
      <th>NACE</th>
      <th>Period</th>
      <th>RecScr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>Baumit Baustoffe Bad Ischl</td>
      <td>AT 1</td>
      <td>Austria</td>
      <td>Cement and Lime</td>
      <td>46415</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4820</td>
      <td>Bad Ischl</td>
      <td>Rettenbach 143</td>
      <td>NaN</td>
      <td>Production of lime, or calcination of dolomite...</td>
      <td>Manufacture of lime and plaster</td>
      <td>23.52</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.0</td>
      <td>Vetropack Pöchlarn</td>
      <td>AT 10</td>
      <td>Austria</td>
      <td>Glass</td>
      <td>59982</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3380</td>
      <td>Pöchlarn</td>
      <td>Manker Strasse 49</td>
      <td>NaN</td>
      <td>Manufacture of glass</td>
      <td>Manufacture of hollow glass</td>
      <td>23.13</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
    </tr>
    <tr>
      <th>2</th>
      <td>101.0</td>
      <td>Verbund FHKW Werndorf 2 Wildon</td>
      <td>AT 101</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>187</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8410</td>
      <td>Neudorf ob Wildon</td>
      <td>Weisseneggweg 1</td>
      <td>NaN</td>
      <td>Combustion of fuels</td>
      <td>Production of electricity</td>
      <td>35.11</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
    </tr>
    <tr>
      <th>3</th>
      <td>103.0</td>
      <td>Kelag Wärme St. Magdalen</td>
      <td>AT 103</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>6218</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9524</td>
      <td>St. Magdalen</td>
      <td>Europastrasse 2</td>
      <td>NaN</td>
      <td>Combustion of fuels</td>
      <td>Steam and air conditioning supply</td>
      <td>35.30</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
    </tr>
    <tr>
      <th>4</th>
      <td>104.0</td>
      <td>Kelag Wärme Prolactal Hartberg</td>
      <td>AT 104</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>1461</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8230</td>
      <td>Hartberg</td>
      <td>Ferd. Leihsstrasse 40</td>
      <td>NaN</td>
      <td>Combustion of fuels</td>
      <td>Steam and air conditioning supply</td>
      <td>35.30</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(10555, 17)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Remove infrastructure from the aviation sector as CO2e emissions are not localised.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span> <span class="o">=</span> <span class="n">sandbag_data</span><span class="p">[</span><span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;SandbagSector&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;Aviation&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(10077, 17)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;InstallationAddress1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;InstallationAddress1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;InstallationAddress2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;InstallationAddress2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;full_address&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;InstallationAddress1&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;InstallationAddress2&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;InstallationPostCode&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;InstallationCity&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;RegCtryName&#39;</span><span class="p">]</span>
<span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;city_address&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;InstallationPostCode&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;InstallationCity&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;RegCtryName&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InstallationNumber</th>
      <th>InstallationName</th>
      <th>Key</th>
      <th>RegCtryName</th>
      <th>SandbagSector</th>
      <th>tCO2e</th>
      <th>InstallationLatitude</th>
      <th>InstallationLongtitude</th>
      <th>InstallationPostCode</th>
      <th>InstallationCity</th>
      <th>InstallationAddress1</th>
      <th>InstallationAddress2</th>
      <th>MainActivityType</th>
      <th>ClassDescription</th>
      <th>NACE</th>
      <th>Period</th>
      <th>RecScr</th>
      <th>full_address</th>
      <th>city_address</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>Baumit Baustoffe Bad Ischl</td>
      <td>AT 1</td>
      <td>Austria</td>
      <td>Cement and Lime</td>
      <td>46415</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4820</td>
      <td>Bad Ischl</td>
      <td>Rettenbach 143</td>
      <td></td>
      <td>Production of lime, or calcination of dolomite...</td>
      <td>Manufacture of lime and plaster</td>
      <td>23.52</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Rettenbach 143  4820 Bad Ischl Austria</td>
      <td>4820 Bad Ischl Austria</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.0</td>
      <td>Vetropack Pöchlarn</td>
      <td>AT 10</td>
      <td>Austria</td>
      <td>Glass</td>
      <td>59982</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3380</td>
      <td>Pöchlarn</td>
      <td>Manker Strasse 49</td>
      <td></td>
      <td>Manufacture of glass</td>
      <td>Manufacture of hollow glass</td>
      <td>23.13</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Manker Strasse 49  3380 Pöchlarn Austria</td>
      <td>3380 Pöchlarn Austria</td>
    </tr>
    <tr>
      <th>2</th>
      <td>101.0</td>
      <td>Verbund FHKW Werndorf 2 Wildon</td>
      <td>AT 101</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>187</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8410</td>
      <td>Neudorf ob Wildon</td>
      <td>Weisseneggweg 1</td>
      <td></td>
      <td>Combustion of fuels</td>
      <td>Production of electricity</td>
      <td>35.11</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Weisseneggweg 1  8410 Neudorf ob Wildon Austria</td>
      <td>8410 Neudorf ob Wildon Austria</td>
    </tr>
    <tr>
      <th>3</th>
      <td>103.0</td>
      <td>Kelag Wärme St. Magdalen</td>
      <td>AT 103</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>6218</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9524</td>
      <td>St. Magdalen</td>
      <td>Europastrasse 2</td>
      <td></td>
      <td>Combustion of fuels</td>
      <td>Steam and air conditioning supply</td>
      <td>35.30</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Europastrasse 2  9524 St. Magdalen Austria</td>
      <td>9524 St. Magdalen Austria</td>
    </tr>
    <tr>
      <th>4</th>
      <td>104.0</td>
      <td>Kelag Wärme Prolactal Hartberg</td>
      <td>AT 104</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>1461</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8230</td>
      <td>Hartberg</td>
      <td>Ferd. Leihsstrasse 40</td>
      <td></td>
      <td>Combustion of fuels</td>
      <td>Steam and air conditioning supply</td>
      <td>35.30</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Ferd. Leihsstrasse 40  8230 Hartberg Austria</td>
      <td>8230 Hartberg Austria</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span> <span class="o">=</span> <span class="n">sandbag_data</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;full_address&#39;</span><span class="p">])]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(9969, 19)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span> <span class="o">=</span> <span class="n">sandbag_data</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;city_address&#39;</span><span class="p">])]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(9969, 19)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">geopy</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Requirement already satisfied: geopy in c:\users\amelie.dubourg\anaconda3\lib\site-packages (1.22.0)
Requirement already satisfied: geographiclib&lt;2,&gt;=1.49 in c:\users\amelie.dubourg\anaconda3\lib\site-packages (from geopy) (1.50)
Note: you may need to restart the kernel to use updated packages.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">geopy.geocoders</span> <span class="kn">import</span> <span class="n">Nominatim</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">locator</span> <span class="o">=</span> <span class="n">Nominatim</span><span class="p">(</span><span class="n">user_agent</span><span class="o">=</span><span class="s2">&quot;myGeocoder&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">geopy.extra.rate_limiter</span> <span class="kn">import</span> <span class="n">RateLimiter</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geocode</span> <span class="o">=</span> <span class="n">RateLimiter</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">,</span> <span class="n">min_delay_seconds</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">error_wait_seconds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">sandbag_data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>9969</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Find-full-address-&amp;-city-address-location">Find full address &amp; city address location<a class="anchor-link" href="#Find-full-address-&amp;-city-address-location"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;full_address_latitude&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;full_address_longitude&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;city_address_latitude&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;city_address_longitude&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InstallationNumber</th>
      <th>InstallationName</th>
      <th>Key</th>
      <th>RegCtryName</th>
      <th>SandbagSector</th>
      <th>tCO2e</th>
      <th>InstallationLatitude</th>
      <th>InstallationLongtitude</th>
      <th>InstallationPostCode</th>
      <th>InstallationCity</th>
      <th>...</th>
      <th>ClassDescription</th>
      <th>NACE</th>
      <th>Period</th>
      <th>RecScr</th>
      <th>full_address</th>
      <th>city_address</th>
      <th>full_address_latitude</th>
      <th>full_address_longitude</th>
      <th>city_address_latitude</th>
      <th>city_address_longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>Baumit Baustoffe Bad Ischl</td>
      <td>AT 1</td>
      <td>Austria</td>
      <td>Cement and Lime</td>
      <td>46415</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4820</td>
      <td>Bad Ischl</td>
      <td>...</td>
      <td>Manufacture of lime and plaster</td>
      <td>23.52</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Rettenbach 143  4820 Bad Ischl Austria</td>
      <td>4820 Bad Ischl Austria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.0</td>
      <td>Vetropack Pöchlarn</td>
      <td>AT 10</td>
      <td>Austria</td>
      <td>Glass</td>
      <td>59982</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3380</td>
      <td>Pöchlarn</td>
      <td>...</td>
      <td>Manufacture of hollow glass</td>
      <td>23.13</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Manker Strasse 49  3380 Pöchlarn Austria</td>
      <td>3380 Pöchlarn Austria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>101.0</td>
      <td>Verbund FHKW Werndorf 2 Wildon</td>
      <td>AT 101</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>187</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8410</td>
      <td>Neudorf ob Wildon</td>
      <td>...</td>
      <td>Production of electricity</td>
      <td>35.11</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Weisseneggweg 1  8410 Neudorf ob Wildon Austria</td>
      <td>8410 Neudorf ob Wildon Austria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>103.0</td>
      <td>Kelag Wärme St. Magdalen</td>
      <td>AT 103</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>6218</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9524</td>
      <td>St. Magdalen</td>
      <td>...</td>
      <td>Steam and air conditioning supply</td>
      <td>35.30</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Europastrasse 2  9524 St. Magdalen Austria</td>
      <td>9524 St. Magdalen Austria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>104.0</td>
      <td>Kelag Wärme Prolactal Hartberg</td>
      <td>AT 104</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>1461</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8230</td>
      <td>Hartberg</td>
      <td>...</td>
      <td>Steam and air conditioning supply</td>
      <td>35.30</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Ferd. Leihsstrasse 40  8230 Hartberg Austria</td>
      <td>8230 Hartberg Austria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 23 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Column 17: full address</span>
<span class="c1"># Column 18: city address</span>
<span class="c1"># Column 19: full address latitude</span>
<span class="c1"># Column 20: full address longitude</span>
<span class="c1"># Column 21: city address latitude</span>
<span class="c1"># Column 22: city address longitude</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="mi">3000</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span><span class="mi">4000</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span><span class="mi">5000</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span><span class="mi">6000</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6000</span><span class="p">,</span><span class="mi">7000</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7000</span><span class="p">,</span><span class="mi">8000</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">8000</span><span class="p">,</span><span class="mi">9000</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9000</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">sandbag_data</span><span class="p">),</span><span class="mi">1</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)):</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">latitude</span>
    <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">longitude</span>
  <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;full_address_latitude&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(4515, 23)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;city_address_latitude&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(3808, 23)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InstallationNumber</th>
      <th>InstallationName</th>
      <th>Key</th>
      <th>RegCtryName</th>
      <th>SandbagSector</th>
      <th>tCO2e</th>
      <th>InstallationLatitude</th>
      <th>InstallationLongtitude</th>
      <th>InstallationPostCode</th>
      <th>InstallationCity</th>
      <th>...</th>
      <th>ClassDescription</th>
      <th>NACE</th>
      <th>Period</th>
      <th>RecScr</th>
      <th>full_address</th>
      <th>city_address</th>
      <th>full_address_latitude</th>
      <th>full_address_longitude</th>
      <th>city_address_latitude</th>
      <th>city_address_longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>Baumit Baustoffe Bad Ischl</td>
      <td>AT 1</td>
      <td>Austria</td>
      <td>Cement and Lime</td>
      <td>46415</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4820</td>
      <td>Bad Ischl</td>
      <td>...</td>
      <td>Manufacture of lime and plaster</td>
      <td>23.52</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Rettenbach 143  4820 Bad Ischl Austria</td>
      <td>4820 Bad Ischl Austria</td>
      <td>47.715953</td>
      <td>13.636275</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.0</td>
      <td>Vetropack Pöchlarn</td>
      <td>AT 10</td>
      <td>Austria</td>
      <td>Glass</td>
      <td>59982</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3380</td>
      <td>Pöchlarn</td>
      <td>...</td>
      <td>Manufacture of hollow glass</td>
      <td>23.13</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Manker Strasse 49  3380 Pöchlarn Austria</td>
      <td>3380 Pöchlarn Austria</td>
      <td>48.206328</td>
      <td>15.219059</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>101.0</td>
      <td>Verbund FHKW Werndorf 2 Wildon</td>
      <td>AT 101</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>187</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8410</td>
      <td>Neudorf ob Wildon</td>
      <td>...</td>
      <td>Production of electricity</td>
      <td>35.11</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Weisseneggweg 1  8410 Neudorf ob Wildon Austria</td>
      <td>8410 Neudorf ob Wildon Austria</td>
      <td>46.909169</td>
      <td>15.484680</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>103.0</td>
      <td>Kelag Wärme St. Magdalen</td>
      <td>AT 103</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>6218</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9524</td>
      <td>St. Magdalen</td>
      <td>...</td>
      <td>Steam and air conditioning supply</td>
      <td>35.30</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Europastrasse 2  9524 St. Magdalen Austria</td>
      <td>9524 St. Magdalen Austria</td>
      <td>46.612475</td>
      <td>13.882636</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>104.0</td>
      <td>Kelag Wärme Prolactal Hartberg</td>
      <td>AT 104</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>1461</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8230</td>
      <td>Hartberg</td>
      <td>...</td>
      <td>Steam and air conditioning supply</td>
      <td>35.30</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Ferd. Leihsstrasse 40  8230 Hartberg Austria</td>
      <td>8230 Hartberg Austria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>47.280937</td>
      <td>15.969177</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 23 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If the location of the full address is available, we select it as the infrastructure location, and otherwise we use the city location.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Column 19: full address latitude</span>
<span class="c1"># Column 20: full address longitude</span>
<span class="c1"># Column 21: city address latitude</span>
<span class="c1"># Column 22: city address longitude</span>
<span class="c1"># Column 23: latitude</span>
<span class="c1"># Column 24: longitude</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sandbag_data</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">19</span><span class="p">]):</span>
        <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">23</span><span class="p">]</span><span class="o">=</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">19</span><span class="p">]</span>
        <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">24</span><span class="p">]</span><span class="o">=</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">21</span><span class="p">]):</span>
        <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">23</span><span class="p">]</span><span class="o">=</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">21</span><span class="p">]</span>
        <span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">24</span><span class="p">]</span><span class="o">=</span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">22</span><span class="p">]</span>
    <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InstallationNumber</th>
      <th>InstallationName</th>
      <th>Key</th>
      <th>RegCtryName</th>
      <th>SandbagSector</th>
      <th>tCO2e</th>
      <th>InstallationLatitude</th>
      <th>InstallationLongtitude</th>
      <th>InstallationPostCode</th>
      <th>InstallationCity</th>
      <th>...</th>
      <th>Period</th>
      <th>RecScr</th>
      <th>full_address</th>
      <th>city_address</th>
      <th>full_address_latitude</th>
      <th>full_address_longitude</th>
      <th>city_address_latitude</th>
      <th>city_address_longitude</th>
      <th>latitude</th>
      <th>longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>Baumit Baustoffe Bad Ischl</td>
      <td>AT 1</td>
      <td>Austria</td>
      <td>Cement and Lime</td>
      <td>46415</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4820</td>
      <td>Bad Ischl</td>
      <td>...</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Rettenbach 143  4820 Bad Ischl Austria</td>
      <td>4820 Bad Ischl Austria</td>
      <td>47.715953</td>
      <td>13.636275</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>47.715953</td>
      <td>13.636275</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.0</td>
      <td>Vetropack Pöchlarn</td>
      <td>AT 10</td>
      <td>Austria</td>
      <td>Glass</td>
      <td>59982</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3380</td>
      <td>Pöchlarn</td>
      <td>...</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Manker Strasse 49  3380 Pöchlarn Austria</td>
      <td>3380 Pöchlarn Austria</td>
      <td>48.206328</td>
      <td>15.219059</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>48.206328</td>
      <td>15.219059</td>
    </tr>
    <tr>
      <th>2</th>
      <td>101.0</td>
      <td>Verbund FHKW Werndorf 2 Wildon</td>
      <td>AT 101</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>187</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8410</td>
      <td>Neudorf ob Wildon</td>
      <td>...</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Weisseneggweg 1  8410 Neudorf ob Wildon Austria</td>
      <td>8410 Neudorf ob Wildon Austria</td>
      <td>46.909169</td>
      <td>15.484680</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>46.909169</td>
      <td>15.484680</td>
    </tr>
    <tr>
      <th>3</th>
      <td>103.0</td>
      <td>Kelag Wärme St. Magdalen</td>
      <td>AT 103</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>6218</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9524</td>
      <td>St. Magdalen</td>
      <td>...</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Europastrasse 2  9524 St. Magdalen Austria</td>
      <td>9524 St. Magdalen Austria</td>
      <td>46.612475</td>
      <td>13.882636</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>46.612475</td>
      <td>13.882636</td>
    </tr>
    <tr>
      <th>4</th>
      <td>104.0</td>
      <td>Kelag Wärme Prolactal Hartberg</td>
      <td>AT 104</td>
      <td>Austria</td>
      <td>Power and heat</td>
      <td>1461</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8230</td>
      <td>Hartberg</td>
      <td>...</td>
      <td>2019.0</td>
      <td>20200415 Data Release</td>
      <td>Ferd. Leihsstrasse 40  8230 Hartberg Austria</td>
      <td>8230 Hartberg Austria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>47.280937</td>
      <td>15.969177</td>
      <td>47.280937</td>
      <td>15.969177</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">sandbag_data</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(8323, 25)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Export-to-Excel">Export to Excel<a class="anchor-link" href="#Export-to-Excel"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandbag_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\Users\amelie.dubourg\Desktop\Personnel\Data for Good\Sandbag\sandbag_data_infrastructure_location.xlsx&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

